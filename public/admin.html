<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ› ï¸ åˆ†åº—è©•åƒ¹ç³»çµ± - ç®¡ç†å¾Œå°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Microsoft JhengHei', sans-serif;
        }
        
        .admin-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .nav-tabs .nav-link {
            border: none;
            border-radius: 15px 15px 0 0;
            color: #6c757d;
            font-weight: 500;
            padding: 15px 25px;
            margin-right: 5px;
        }
        
        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 500;
            padding: 10px 25px;
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            color: white;
        }
        
        .btn-outline-gradient {
            border: 2px solid;
            border-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%) 1;
            background: transparent;
            color: #667eea;
            border-radius: 25px;
            font-weight: 500;
            padding: 8px 20px;
            transition: all 0.3s ease;
        }
        
        .btn-outline-gradient:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .store-item, .group-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .store-item:hover, .group-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .platform-url {
            background: white;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #e9ecef;
        }
        
        .status-badge {
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .form-control, .form-select {
            border-radius: 10px;
            border: 1px solid #e9ecef;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .alert {
            border-radius: 15px;
            border: none;
            padding: 15px 20px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
        }
        
        .spinner-border {
            color: #667eea;
        }
        
        .modal-content {
            border-radius: 20px;
            border: none;
        }
        
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px 20px 0 0;
        }
        
        .schedule-info {
            background: linear-gradient(135deg, #17a2b8 0%, #007bff 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .platform-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-12 col-xl-10">
                <div class="admin-container p-4">
                    <!-- Header -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h2 class="mb-1">ğŸ› ï¸ ç³»çµ±ç®¡ç†å¾Œå°</h2>
                            <p class="text-muted mb-0">åˆ†åº—è©•åƒ¹è‡ªå‹•åŒ–æŸ¥è©¢ç³»çµ±è¨­å®š</p>
                        </div>
                        <div>
                            <button class="btn btn-outline-gradient me-2" onclick="window.open('/', '_blank')">
                                <i class="fas fa-external-link-alt"></i> æŸ¥è©¢é é¢
                            </button>
                            <button class="btn btn-gradient" onclick="saveAllSettings()">
                                <i class="fas fa-save"></i> å„²å­˜è¨­å®š
                            </button>
                        </div>
                    </div>

                    <!-- Navigation Tabs -->
                    <ul class="nav nav-tabs mb-4" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#stores-tab">
                                <i class="fas fa-store"></i> åˆ†åº—ç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#groups-tab">
                                <i class="fas fa-users"></i> é€šçŸ¥ç¾¤çµ„
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#schedule-tab">
                                <i class="fas fa-clock"></i> æ’ç¨‹è¨­å®š
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#logs-tab">
                                <i class="fas fa-list-alt"></i> åŸ·è¡Œè¨˜éŒ„
                            </a>
                        </li>
                    </ul>

                    <!-- Tab Content -->
                    <div class="tab-content">
                        <!-- åˆ†åº—ç®¡ç† Tab -->
                        <div class="tab-pane fade show active" id="stores-tab">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0"><i class="fas fa-store"></i> åˆ†åº—åˆ—è¡¨</h5>
                                            <button class="btn btn-gradient btn-sm" onclick="addNewStore()">
                                                <i class="fas fa-plus"></i> æ–°å¢åˆ†åº—
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="stores-list">
                                                <!-- åˆ†åº—åˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="fas fa-info-circle"></i> ä½¿ç”¨èªªæ˜</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="alert alert-info">
                                                <h6>ğŸ“‹ æ”¯æ´å¹³å°ï¼š</h6>
                                                <ul class="mb-2">
                                                    <li>ğŸ—ºï¸ Google Maps</li>
                                                    <li>ğŸš— UberEats</li>
                                                    <li>ğŸ¼ Foodpanda</li>
                                                </ul>
                                                <hr>
                                                <h6>ğŸ”— ç¶²å€æ ¼å¼ï¼š</h6>
                                                <small>
                                                    â€¢ Google Maps æ”¯æ´çŸ­ç¶²å€<br>
                                                    â€¢ UberEats éœ€è¦å®Œæ•´å•†åº—ç¶²å€<br>
                                                    â€¢ Foodpanda æ”¯æ´çŸ­é€£çµ
                                                </small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="stats-card mt-3">
                                        <h6><i class="fas fa-chart-bar"></i> çµ±è¨ˆè³‡è¨Š</h6>
                                        <div class="row text-center mt-3">
                                            <div class="col-6">
                                                <h4 id="total-stores">0</h4>
                                                <small>ç¸½åˆ†åº—æ•¸</small>
                                            </div>
                                            <div class="col-6">
                                                <h4 id="total-platforms">0</h4>
                                                <small>ç¸½å¹³å°æ•¸</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- é€šçŸ¥ç¾¤çµ„ Tab -->
                        <div class="tab-pane fade" id="groups-tab">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0"><i class="fas fa-users"></i> Telegram é€šçŸ¥ç¾¤çµ„</h5>
                                            <button class="btn btn-gradient btn-sm" onclick="addNewGroup()">
                                                <i class="fas fa-plus"></i> æ–°å¢ç¾¤çµ„
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="groups-list">
                                                <!-- ç¾¤çµ„åˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="fas fa-robot"></i> Telegram è¨­å®š</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label class="form-label">Bot Token</label>
                                                <input type="text" class="form-control" id="bot-token" 
                                                       placeholder="è«‹è¼¸å…¥ Telegram Bot Token">
                                                <small class="text-muted">å¾ @BotFather ç²å–</small>
                                            </div>
                                            <button class="btn btn-outline-gradient w-100" onclick="testAllGroups()">
                                                <i class="fas fa-paper-plane"></i> æ¸¬è©¦æ‰€æœ‰ç¾¤çµ„
                                            </button>
                                        </div>
                                    </div>

                                    <div class="alert alert-warning mt-3">
                                        <h6><i class="fas fa-exclamation-triangle"></i> é‡è¦æé†’</h6>
                                        <ul class="mb-0">
                                            <li>ç¢ºä¿Botå·²åŠ å…¥æ‰€æœ‰ç¾¤çµ„</li>
                                            <li>ç¾¤çµ„IDå¿…é ˆåŒ…å«è² è™Ÿ(-)</li>
                                            <li>å»ºè­°å…ˆæ¸¬è©¦å†å•Ÿç”¨</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- æ’ç¨‹è¨­å®š Tab -->
                        <div class="tab-pane fade" id="schedule-tab">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="schedule-info">
                                        <h5><i class="fas fa-clock"></i> é›²ç«¯è‡ªå‹•åŒ–æ’ç¨‹</h5>
                                        <p class="mb-2">ç³»çµ±å°‡è‡ªå‹•åœ¨æŒ‡å®šæ™‚é–“åŸ·è¡ŒæŸ¥è©¢ä¸¦ç™¼é€é€šçŸ¥</p>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <strong>ç›®å‰è¨­å®šï¼š</strong> æ¯å¤©å‡Œæ™¨ 01:00
                                            </div>
                                            <div class="col-md-6">
                                                <strong>ç‹€æ…‹ï¼š</strong> 
                                                <span class="badge bg-success">å·²å•Ÿç”¨</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="fas fa-cog"></i> æ’ç¨‹é…ç½®</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">åŸ·è¡Œæ™‚é–“</label>
                                                        <select class="form-select" id="schedule-time">
                                                            <option value="01:00">å‡Œæ™¨ 01:00</option>
                                                            <option value="02:00">å‡Œæ™¨ 02:00</option>
                                                            <option value="03:00">å‡Œæ™¨ 03:00</option>
                                                            <option value="06:00">æ—©ä¸Š 06:00</option>
                                                            <option value="12:00">ä¸­åˆ 12:00</option>
                                                            <option value="18:00">ä¸‹åˆ 18:00</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">åŸ·è¡Œé »ç‡</label>
                                                        <select class="form-select" id="schedule-frequency">
                                                            <option value="daily">æ¯å¤©</option>
                                                            <option value="weekdays">å·¥ä½œæ—¥</option>
                                                            <option value="weekly">æ¯é€±</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="mb-3">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="enable-schedule" checked>
                                                    <label class="form-check-label" for="enable-schedule">
                                                        å•Ÿç”¨è‡ªå‹•æ’ç¨‹
                                                    </label>
                                                </div>
                                            </div>

                                            <div class="d-flex gap-2">
                                                <button class="btn btn-gradient" onclick="updateSchedule()">
                                                    <i class="fas fa-save"></i> æ›´æ–°æ’ç¨‹
                                                </button>
                                                <button class="btn btn-outline-gradient" onclick="testSchedule()">
                                                    <i class="fas fa-play"></i> ç«‹å³æ¸¬è©¦
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="fas fa-info"></i> æ’ç¨‹èªªæ˜</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="alert alert-info">
                                                <h6>â° æ™‚é–“èªªæ˜ï¼š</h6>
                                                <p class="mb-2">æ‰€æœ‰æ™‚é–“å‡ç‚ºå°ç£æ™‚é–“(GMT+8)</p>
                                                
                                                <h6>ğŸ”„ åŸ·è¡Œæµç¨‹ï¼š</h6>
                                                <ol class="mb-0">
                                                    <li>è‡ªå‹•å•Ÿå‹•æŸ¥è©¢</li>
                                                    <li>ä¾åºæª¢æŸ¥å„åˆ†åº—</li>
                                                    <li>æ”¶é›†è©•åƒ¹æ•¸æ“š</li>
                                                    <li>ç™¼é€Telegramé€šçŸ¥</li>
                                                    <li>è¨˜éŒ„åŸ·è¡Œæ—¥èªŒ</li>
                                                </ol>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card mt-3">
                                        <div class="card-header">
                                            <h6 class="mb-0"><i class="fas fa-chart-line"></i> ä¸‹æ¬¡åŸ·è¡Œ</h6>
                                        </div>
                                        <div class="card-body text-center">
                                            <h5 id="next-execution">è¨ˆç®—ä¸­...</h5>
                                            <small class="text-muted">é è¨ˆåŸ·è¡Œæ™‚é–“</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- åŸ·è¡Œè¨˜éŒ„ Tab -->
                        <div class="tab-pane fade" id="logs-tab">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-list-alt"></i> åŸ·è¡Œè¨˜éŒ„</h5>
                                    <div>
                                        <button class="btn btn-outline-gradient btn-sm me-2" onclick="refreshLogs()">
                                            <i class="fas fa-sync-alt"></i> é‡æ–°æ•´ç†
                                        </button>
                                        <button class="btn btn-gradient btn-sm" onclick="clearLogs()">
                                            <i class="fas fa-trash"></i> æ¸…é™¤è¨˜éŒ„
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="execution-logs">
                                        <!-- åŸ·è¡Œè¨˜éŒ„å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- åˆ†åº—ç·¨è¼¯ Modal -->
    <div class="modal fade" id="storeModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-store"></i> åˆ†åº—è¨­å®š</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="store-form">
                        <input type="hidden" id="store-id">
                        
                        <div class="mb-3">
                            <label class="form-label">åˆ†åº—åç¨± *</label>
                            <input type="text" class="form-control" id="store-name" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Google Maps ç¶²å€</label>
                            <input type="url" class="form-control" id="google-url" 
                                   placeholder="https://maps.app.goo.gl/...">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">UberEats ç¶²å€</label>
                            <input type="url" class="form-control" id="uber-url" 
                                   placeholder="https://www.ubereats.com/store/...">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Foodpanda ç¶²å€</label>
                            <input type="url" class="form-control" id="panda-url" 
                                   placeholder="https://foodpanda.page.link/...">
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="store-enabled" checked>
                            <label class="form-check-label" for="store-enabled">
                                å•Ÿç”¨æ­¤åˆ†åº—
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-gradient" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-gradient" onclick="saveStore()">å„²å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¾¤çµ„ç·¨è¼¯ Modal -->
    <div class="modal fade" id="groupModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-users"></i> Telegram ç¾¤çµ„</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="group-form">
                        <input type="hidden" id="group-id">
                        
                        <div class="mb-3">
                            <label class="form-label">ç¾¤çµ„åç¨± *</label>
                            <input type="text" class="form-control" id="group-name" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">ç¾¤çµ„ ID *</label>
                            <input type="text" class="form-control" id="group-chat-id" 
                                   placeholder="-1002658082392" required>
                            <small class="text-muted">å¿…é ˆåŒ…å«è² è™Ÿ(-)ï¼Œå¾ç¾¤çµ„è³‡è¨Šä¸­ç²å–</small>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="group-enabled" checked>
                            <label class="form-check-label" for="group-enabled">
                                å•Ÿç”¨æ­¤ç¾¤çµ„
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-gradient" onclick="testSingleGroup()">
                        <i class="fas fa-paper-plane"></i> æ¸¬è©¦
                    </button>
                    <button type="button" class="btn btn-outline-gradient" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-gradient" onclick="saveGroup()">å„²å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center p-4">
                    <div class="spinner-border mb-3" role="status"></div>
                    <h6 id="loading-text">è™•ç†ä¸­...</h6>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="admin.js"></script>
</body>
</html>